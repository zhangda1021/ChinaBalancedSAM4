GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


       
              Production activities   A (30) (1-30)
              Commodities             C (30) (31-60)
              Primary Factors         F (2)  (61-62: 61:labor, 62: capital)
              Households              H (1)  (63)
              Central Government      G1(1)  (64)
              Provincial Government   G2(1)  (65)
              Types of taxes          T (4)  (66-69: 66: production tax, 67: commodity tax, 68: factor tax, 69: income tax)
              Rest of country         DX(1)  (70: domestic inflow and outflow)
              Rest of world           X (1)  (71: import and export)
              Investment-savings      I (2)  (72: Capital formation, 73: Inventory change)
              Trade margin            M (1)  (74)
       
      Here is a "MAP" of the SAM with the names of the submatrices which
      contain data.  All cells with no labels are empty:
       
       
       
                 A       C        F       H      G1      G2       T       DX      X      I1      I2      M
              ------------------------------------------------------------------------------------------------
      A       |       |   ac  |       |       |       |       |   sa  |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
      C       |   ca  |       |       |   ch  |       |  g2d  |       |   der |   er  |  cs1  |  cs2  |  trn  |
              ------------------------------------------------------------------------------------------------
      F       |   fa  |       |       |       |       |       |       |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
      H       |       |       |   hf  |       |       |  hg2  |       |   dhr |   hr  |       |       |       |
              ------------------------------------------------------------------------------------------------
      G1      |       |       |       |       |       |  g1g2 |       |       |       |  cg1s |       |       |
              ------------------------------------------------------------------------------------------------
      G2      |       |       |       |       | g2g1  |       |   tr  |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
      T       |   ta  |       |       |       |       |       |       |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
      DX      |       |  drc  |       |  drh  |       |       |       |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
      X       |       |   rc  |       |   rh  |       |       |       |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
      I1      |       |       |   dp  |  psv1 | g1sv  |       |       |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
      I2      |       |   ic  |       |  psv2 |       |       |       |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
      M       |       |   mrg |       |       |       |       |       |       |       |       |       |       |
              ------------------------------------------------------------------------------------------------
  47   
  51   
  52  *SAM table
  53  set     i_   SAM rows and colums indices   /
  54          1*30    Industries,
  55          31*60   Commodities,
  56          61      Labor,
  57          62      Capital,
  58          63      Household,
  59          64      Central Government,
  60          65      Local Government,
  61          66      Production tax,
  62          67      Commodity tax,
  63          68      Factor tax,
  64          69      Income tax,
  65          70      Domestic trade,
  66          71      Foreign trade,
  67          72      Investment,
  68          73      Inventory,
  69          74      Domestic trade margin/;
  70  alias (i_,j_);
  71   
  72  set     rs     All regions (intra- and international)/
  73          CHN,JPN,KOR,IDN,IND,CAN,USA,MEX,ARG,BRA,FRA,DEU,ITA,GBR,RUS,TUR,XWS,ZAF,ANZ,REU,LIC,MIC,BEJ,TAJ,HEB,SHX,NMG,L
      IA,JIL,HLJ,SHH,JSU,ZHJ,ANH,FUJ,JXI,SHD,HEN,HUB,HNA,GUD,GXI,HAI,CHQ,SIC,GZH,YUN,SHA,GAN,NXA,QIH,XIN/;
  74  alias (rs,rsrs,rsrsrs);
  75   
  76  set     r_(rs)  China provinces       /BEJ,TAJ,HEB,SHX,NMG,LIA,JIL,HLJ,SHH,JSU,ZHJ,ANH,FUJ,JXI,SHD,HEN,HUB,HUN,GUD,GX
****                                                                                                               $170
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


      I,HAI,CHQ,SIC,GZH,YUN,SHA,GAN,NXA,QIH,XIN/;
  77  set     r(rs)   China provinces       /BEJ,TAJ,HEB,SHX,NMG,LIA,JIL,HLJ,SHH,JSU,ZHJ,ANH,FUJ,JXI,SHD,HEN,HUB,HNA,GUD,GX
      I,HAI,CHQ,SIC,GZH,YUN,SHA,GAN,NXA,QIH,XIN/;
  78   
  79  *       Map r_ set to new r:
  80  *       Hunan has the same abrev. with Hungary, so its abbrev. has been changed to HNA...
  81  set     mapr(r_,rs) /
  82          BEJ.BEJ
  83          TAJ.TAJ
  84          HEB.HEB
  85          SHX.SHX
  86          NMG.NMG
  87          LIA.LIA
  88          JIL.JIL
  89          HLJ.HLJ
  90          SHH.SHH
  91          JSU.JSU
  92          ZHJ.ZHJ
  93          ANH.ANH
  94          FUJ.FUJ
  95          JXI.JXI
  96          SHD.SHD
  97          HEN.HEN
  98          HUB.HUB
  99          HUN.HNA
 100          GUD.GUD
 101          GXI.GXI
 102          HAI.HAI
 103          CHQ.CHQ
 104          SIC.SIC
 105          GZH.GZH
 106          YUN.YUN
 107          SHA.SHA
 108          GAN.GAN
 109          NXA.NXA
 110          QIH.QIH
 111          XIN.XIN
 112  /;
 113   
 114  parameter sam4__(r_,i_,j_)           SAM v4;
GDXIN   C:\Users\dzhang\Dropbox\ChinaBalancedSAM\/data/gdx/finalbalancing2/sam4.gdx
--- LOAD  sam4__ = 37:sam4
 118   
 119   
 120  parameter sam4_(rs,i_,j_) SAM data;
 121  sam4_(rs,i_,j_)=sum(mapr(r_,rs),sam4__(r_,i_,j_));
 122   
 123   
 124   
 125  set
 126          s(rs)   Inter-national regions (GTAP);
GDXIN   C:\Users\dzhang\Dropbox\ChinaBalancedSAM\/data/gdx/chinamodel.gdx
--- LOAD  s = 2:r
 130  alias(s,ss);
 131   
 132   
 133  set     province(rs);
 134  set     GTAPregions(rs);
 135   
 136  province(r)=yes;
 137  GTAPregions(s)=yes;
 138   
 139   
 140   
 141  *----------------------------------------------------------------------------------
 142  *        LET TIME GOES BACK TO 2004
 143  *----------------------------------------------------------------------------------
 144  * The exchange rate from RMB to US dollar is 7.5215
 145  * China's GDP is 26,581 billion yuan in 2007 and 15,988 billion yuan in 2004. The ratio is 1.6626.
 146  sam4_(rs,i_,j_)=sam4_(rs,i_,j_)/7.5215/1.6626;
 147   
 148   
 149  *----------------------------------------------------------------------------------
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 150  *        SECTOR AGGREGATION TO BE COMSISTENT WITH GTAP
 151  *----------------------------------------------------------------------------------
 152  set     i   SAM rows and colums indices   /
 153          1*26    Industries,
 154          27*52   Commodities,
 155          53      Labor,
 156          54      Capital,
 157          55      Household,
 158          56      Central Government,
 159          57      Local Government,
 160          58      Production tax,
 161          59      Commodity tax,
 162          60      Factor tax,
 163          61      Income tax,
 164          62      Domestic trade,
 165          63      Foreign trade,
 166          64      Investment,
 167          65      Inventory,
 168          66      Domestic trade margin/;
 169  alias (i,j);
 170  set     mapi(i_,i)/
 171          1.1
 172          2.2
 173          3.3
 174          4.5
 175          5.5
 176          6.6
 177          7.7
 178          8.8
 179          9.9
 180          10.10
 181          11.11
 182          12.12
 183          13.13
 184          14.14
 185          15.15
 186          16.16
 187          17.17
 188          18.16
 189          19.18
 190          20.16
 191          21.19
 192          22.19
 193          23.20
 194          24.21
 195          25.22
 196          26.23
 197          27.25
 198          28.24
 199          29.26
 200          30.4
 201          31.27
 202          32.28
 203          33.29
 204          34.31
 205          35.31
 206          36.32
 207          37.33
 208          38.34
 209          39.35
 210          40.36
 211          41.37
 212          42.38
 213          43.39
 214          44.40
 215          45.41
 216          46.42
 217          47.43
 218          48.42
 219          49.44
 220          50.42
 221          51.45
 222          52.45
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 223          53.46
 224          54.47
 225          55.48
 226          56.49
 227          57.51
 228          58.50
 229          59.52
 230          60.30
 231          61.53
 232          62.54
 233          63.55
 234          64.56
 235          65.57
 236          66.58
 237          67.59
 238          68.60
 239          69.61
 240          70.62
 241          71.63
 242          72.64
 243          73.65
 244          74.66
 245  /;
 246  set     mapj(j_,j)/
 247          1.1
 248          2.2
 249          3.3
 250          4.5
 251          5.5
 252          6.6
 253          7.7
 254          8.8
 255          9.9
 256          10.10
 257          11.11
 258          12.12
 259          13.13
 260          14.14
 261          15.15
 262          16.16
 263          17.17
 264          18.16
 265          19.18
 266          20.16
 267          21.19
 268          22.19
 269          23.20
 270          24.21
 271          25.22
 272          26.23
 273          27.25
 274          28.24
 275          29.26
 276          30.4
 277          31.27
 278          32.28
 279          33.29
 280          34.31
 281          35.31
 282          36.32
 283          37.33
 284          38.34
 285          39.35
 286          40.36
 287          41.37
 288          42.38
 289          43.39
 290          44.40
 291          45.41
 292          46.42
 293          47.43
 294          48.42
 295          49.44
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 296          50.42
 297          51.45
 298          52.45
 299          53.46
 300          54.47
 301          55.48
 302          56.49
 303          57.51
 304          58.50
 305          59.52
 306          60.30
 307          61.53
 308          62.54
 309          63.55
 310          64.56
 311          65.57
 312          66.58
 313          67.59
 314          68.60
 315          69.61
 316          70.62
 317          71.63
 318          72.64
 319          73.65
 320          74.66
 321  /;
 322  parameter sam4(rs,i,j) AGGREGATED SAM DATA;
 323  sam4(rs,i,j)=sum(mapi(i_,i),sum(mapj(j_,j),sam4_(rs,i_,j_)));
 324   
 325  set mapij(i,j)/
 326          1.27
 327          2.28
 328          3.29
 329          4.30
 330          5.31
 331          6.32
 332          7.33
 333          8.34
 334          9.35
 335          10.36
 336          11.37
 337          12.38
 338          13.39
 339          14.40
 340          15.41
 341          16.42
 342          17.43
 343          18.44
 344          19.45
 345          20.46
 346          21.47
 347          22.48
 348          23.49
 349          24.50
 350          25.51
 351          26.52
 352  /;
 353   
 354   
 355   
 356  *-------------------------------------------------------------------
 357  *       Read GTAP data:
 358  *-------------------------------------------------------------------
 359  set tp_(i)/25/;
 360   
 361  parameter       vxmd(i,rs,rsrs)              Trade - bilateral exports at market prices;
 362  parameter       vst_(tp_,rs)                 Exported transportation service;
 363  parameter       vtwr_(tp_,i,rs,rsrs)         Trade margin;
 364  parameter       rtms(i,rs,rsrs)              Import tax rate;
 365  parameter       rtxs(i,rs,rsrs)              Export tax rate;
 366   
 367   
GDXIN   C:\Users\dzhang\Dropbox\ChinaBalancedSAM\/data/gdx/gsd_001.gdx
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


--- LOAD  vxmd = 8:vxmd
--- LOAD  vst_ = 9:vst
--- LOAD  vtwr_ = 10:vtwr
--- LOAD  rtms = 16:rtms
--- LOAD  rtxs = 15:rtxs
 375   
 376  parameter       vxmdexp(i)              China's export by sector;
 377  vxmdexp(i)=sum(rs,vxmd(i,"CHN",rs));
 378  parameter       vxmdimp(i)              China's import by sector;
 379  vxmdimp(i)=sum(rs,vxmd(i,rs,"CHN"));
 380  display vxmdexp,vxmdimp;
 381   
 382  *----------------------------------------------------------------------------------
 383  *       DISTRIBUTION OF IMPORT AND EXPORT DATA
 384  *----------------------------------------------------------------------------------
 385  * There is no export for crude oil in China data, but positive value in GTAP data
 386  parameter       oilsupply(r);
 387  oilsupply(r)=sam4(r,"3","29");
 388  parameter       totoilsupply;
 389  totoilsupply=sum(r,oilsupply(r));
 390  sam4(r,"3","29")=sam4(r,"3","29")+vxmdexp("3")/totoilsupply*oilsupply(r);
 391  sam4(r,"29","63")=vxmdexp("3")/totoilsupply*oilsupply(r);
 392   
 393  * Calculation of China's import and export by sector from China data
 394  parameter vim_(j,rs);
 395  vim_(j,rs)$((ord(j)>=27) and (ord(j)<=52))=sam4(rs,"63",j);
 396  parameter vxm_(i,rs);
 397  vxm_(j,rs)$((ord(j)>=27) and (ord(j)<=52))=sam4(rs,j,"63");
 398  parameter vim(i,rs);
 399  vim(i,rs)=sum(mapij(i,j),vim_(j,rs));
 400  parameter vxm(i,rs);
 401  vxm(i,rs)=sum(mapij(i,j),vxm_(j,rs));
 402  *display vim,vxm;
 403   
 404  * Distribute national import and export among provinces
 405  vxmd(i,rs,rsrs)$(province(rs))=vxmd(i,"CHN",rsrs)/sum(rsrsrs,(vxm(i,rsrsrs)))*vxm(i,rs);
 406  vxmd(i,rs,rsrs)$(province(rsrs) and (sum(rsrsrs,(vim(i,rsrsrs)))))=vxmd(i,rs,"CHN")/sum(rsrsrs,(vim(i,rsrsrs)))*vim(i
      ,rsrs);
 407  *display vxmd;
 408   
 409  * Adjustment of SAM table
 410  sam4(rs,j,"63")$(province(rs) and (ord(j)>=27) and (ord(j)<=52))=sum(mapij(i,j),sum(rsrs,vxmd(i,rs,rsrs)));
 411  sam4(rs,"63",j)$(province(rs) and (ord(j)>=27) and (ord(j)<=52))=sum(mapij(i,j),sum(rsrs,vxmd(i,rsrs,rs)));
 412   
 413   
 414  *----------------------------------------------------------------------------------
 415  *       DISTRIBUTION OF TRADE MARGIN
 416  *----------------------------------------------------------------------------------
 417  parameter       vtwr(i,rs,rsrs)         Trade margin;
 418  vtwr(i,rs,rsrs)=sum(tp_,vtwr_(tp_,i,rs,rsrs));
 419   
 420  vtwr(i,rs,rsrs)$(province(rs))=vtwr(i,"CHN",rsrs)/sum(rsrsrs,(vxm(i,rsrsrs)))*vxm(i,rs);
 421  vtwr(i,rs,rsrs)$(province(rsrs) and (sum(rsrsrs,(vim(i,rsrsrs)))))=vtwr(i,rs,"CHN")/sum(rsrsrs,(vim(i,rsrsrs)))*vim(i
      ,rsrs);
 422   
 423  sam4(rs,"63",j)$(province(rs) and (ord(j)>=27) and (ord(j)<=52))=sam4(rs,"63",j)+sum(mapij(i,j),sum(rsrs,vtwr(i,rsrs,
      rs)));
 424  *display vtwr;
 425   
 426  *----------------------------------------------------------------------------------
 427  *        DISTRIBUTION OF EXPORT TRANSPORTATION SERVICE
 428  *----------------------------------------------------------------------------------
 429  parameter       vst(rs);
 430  vst(rs)=sum(tp_,vst_(tp_,rs));
 431  parameter       trpsupply(rs);
 432  trpsupply(r)=sam4(r,"25","51");
 433  parameter       tottrpsupply;
 434  tottrpsupply=sum(rs,trpsupply(rs));
 435  vst(rs)$(province(rs))=vst("CHN")/tottrpsupply*trpsupply(rs);
 436   
 437  sam4(rs,"51","63")$(province(rs))=sam4(rs,"51","63")+vst(rs);
 438  sam4(rs,"25","51")$(province(rs))=sam4(rs,"25","51")+vst(rs);
 439  *display vst;
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 440   
 441   
 442  *----------------------------------------------------------------------------------
 443  *        ADD IMPORT TAX AND EXPORT SUBSIDY TO THE UNBALANCED SAM TABLE
 444  *----------------------------------------------------------------------------------
      * Calculation of aggregated import tax rate and export subsidy rate
      parameter       rtms(i,rs,rsrs)            Import tax rate;
      parameter       rtxs(i,rs,rsrs)            Export subsidy rate;
      tms(i,s,ss)=sum(mapii(i__,i),rtms_(i__,s,ss)*(1-rtxs_(i__,s,ss))*vxmd_(i__,s,ss)+vtwr_(i__,s,ss)*rtms_(i__,s,ss));
      txs(i,s,ss)=sum(mapii(i__,i),rtxs_(i__,s,ss)*vxmd_(i__,s,ss));
       
      rtxs(i,s,ss)$(vxmd(i,s,ss))=txs(i,s,ss)/vxmd(i,s,ss);
      rtms(i,s,ss)$(vxmd(i,s,ss)+vtwr(i,s,ss))=tms(i,s,ss)/(vxmd(i,s,ss)*(1-rtxs(i,s,ss))+vtwr(i,s,ss));
 455   
 456  * Calculate rtxs and rtms for each province
 457  parameter       tms(i,rs,rsrs)             Total Import tax collected;
 458  parameter       txs(i,rs,rsrs)             Total Export subsidy;
 459   
 460  * Import tax collected by provinces
 461  tms(i,rs,rsrs)$(province(rsrs))=rtms(i,rs,"CHN")*vxmd(i,rs,rsrs)*(1-rtxs(i,rs,"CHN"))+vtwr(i,rs,rsrs)*rtms(i,rs,"CHN"
      );
 462  sam4(rsrs,"59",j)$(province(rsrs))=sum(mapij(i,j),sum(rs,tms(i,rs,rsrs)));
 463  * Import tax collected by other countries from provinces
 464  tms(i,rs,rsrs)$(province(rs))=rtms(i,"CHN",rsrs)*vxmd(i,rs,rsrs)*(1-rtxs(i,"CHN",rsrs))+vtwr(i,rs,rsrs)*rtms(i,"CHN",
      rsrs);
 465   
 466   
 467  txs(i,rs,rsrs)$(province(rs))=rtxs(i,"CHN",rsrs)*vxmd(i,rs,rsrs);
 468  * Subsidy rate is negative, so here we give positive value in sam
 469  sam4(rs,i,"59")$(province(rs))=-sum(rsrs,txs(i,rs,rsrs));
 470  txs(i,rs,rsrs)$(province(rsrs))=rtxs(i,rs,"CHN")*vxmd(i,rs,rsrs);
 471   
 472  sam4(rs,"57","59")$(province(rs))=sum(i,sam4(rs,"59",i))-sum(i,sam4(rs,i,"59"));
 473   
 474  rtxs(i,rs,rsrs)$(vxmd(i,rs,rsrs))=txs(i,rs,rsrs)/vxmd(i,rs,rsrs);
 475  rtms(i,rs,rsrs)$(vxmd(i,rs,rsrs)+vtwr(i,rs,rsrs))=tms(i,rs,rsrs)/(vxmd(i,rs,rsrs)*(1-rtxs(i,rs,rsrs))+vtwr(i,rs,rsrs)
      );
 476   
 477   
 478  *----------------------------------------------------------------------------------
 479  *        FINAL BALANCING
 480  *----------------------------------------------------------------------------------
 481  positive variables finalsam (r,i,j)
 482  positive variables rowsum(r,i)
 483  positive variables columnsum(r,i)
 484  positive variables domesticinsum(i)
 485  positive variables domesticoutsum(i)
 486  variable jj
 487   
 488  Equations
 489          rsum
 490          csum
 491          sumbalance
 492          drcsum
 493          dxsum
 494          tradebalance
 495  *       gtapimp
 496  *       gtapexp
 497  *       gtapexptrp
 498          expleprd
 499          obj
 500  ;
 501   
 502  rsum(r,i)..
 503  sum(j,finalsam(r,i,j))=e=rowsum(r,i);
 504   
 505  csum(r,i)..
 506  sum(j,finalsam(r,j,i))=e=columnsum(r,i);
 507   
 508  sumbalance(r,i)..
 509  rowsum(r,i)=e=columnsum(r,i);
 510   
 511  drcsum(i)$((ord(i)>=27) and (ord(i)<=52))..
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 8
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 512  domesticinsum(i)=e=sum(r,finalsam(r,"62",i));
 513   
 514  dxsum(i)$((ord(i)>=27) and (ord(i)<=52))..
 515  domesticoutsum(i)=e=sum(r,finalsam(r,i,"62"));
 516   
 517  tradebalance(i)$((ord(i)>=27) and (ord(i)<=52))..
 518  domesticinsum(i)=e=domesticoutsum(i);
      gtapimp(i,j)$(((ord(i)>=27) and (ord(i)<=52)) and (ord(j)=ord(i)-26))..
      sum(r,finalsam(r,"63",i))=e=vxmdimp(j)+tottwrimp(j);
      gtapexp(i,j)$((((ord(i)>=27) and (ord(i)<=50)) or (ord(i)=52)) and (ord(j)=ord(i)-26))..
      sum(r,finalsam(r,i,"63"))=e=vxmdexp(j);
      gtapexptrp..
      sum(r,finalsam(r,"51","63"))=e=vxmdexp("25")+vst;
 527   
 528  *Export is less than or equal to production
 529  expleprd(r,i,j)$(((ord(i)>=27) and (ord(i)<=52)) and (ord(j)=ord(i)-26))..
 530  finalsam(r,j,i)=g=finalsam(r,i,"63")+finalsam(r,i,"62");
 531   
 532  obj..
 533  *jj=e=sum(r,sum(i,sum(j,sqr(finalsam(r,i,j)-sam4(r,i,j)))));
 534  jj=e=sum(r,sum(i,sum(j,sqr(finalsam(r,i,j)-sam4(r,i,j)))))+10000*sum(r,sum(i$((ord(i)=28) or (ord(i)=29) or (ord(i)=3
      0) or (ord(i)=37) or (ord(i)=46) or (ord(i)=47) or (ord(i)=62) or (ord(i)=63)),sum(j$((ord(j)=2) or (ord(j)=3) or (or
      d(j)=4) or (ord(j)=11) or (ord(j)=20) or (ord(j)=21) or (ord(j)=62) or (ord(j)=63)),sqr(finalsam(r,i,j)-sam4(r,i,j)))
      ));
 535   
 536  Model gua /all/;
 537  loop(r,
 538  loop(i,
 539  loop(j,
 540  finalsam.l(r,i,j)=sam4(r,i,j);
 541  );););
 542  *$ontext
 543  * Make the foreign trade balancing term flexible to change
 544  loop(r,
 545  if(finalsam.l(r,"55","63")=0,finalsam.l(r,"55","63")=1e-6);
 546  if(finalsam.l(r,"63","55")=0,finalsam.l(r,"63","55")=1e-6);
 547  );
 548  *$offtext
 549   
 550  loop(r,
 551  loop(i,
 552  loop(j,
 553  if (finalsam.l(r,i,j)=0,
 554  finalsam.fx(r,i,j)=0;
 555  );
 556  );
 557  );
 558  );
 559   
 560  finalsam.fx(r,i,"63")$((ord(i)>=27) and (ord(i)<=52))=finalsam.l(r,i,"63");
 561  finalsam.fx(r,"63",i)$((ord(i)>=27) and (ord(i)<=52))=finalsam.l(r,"63",i);
 562  finalsam.fx(r,i,"59")=finalsam.l(r,i,"59");
 563  finalsam.fx(r,"59",i)=finalsam.l(r,"59",i);
 564   
 565  gua.iterlim=100000;
 566  gua.reslim=100000000000;
 567  Solve gua minimizing jj using nlp;
****                                   $257
 568  display finalsam.l;
 569   
 570   
 571  set     negval5(i,j)     Flag for negative elements;
 572  set     empty5(i,*)      Flag for empty rows and columns;
 573  parameter       chkfinalsam(i,*)       Consistency check of social accounts;
 574  parameter totoutput3(r);
 575  loop(r,
 576  totoutput3(r)=0;
 577  );
 578  loop(r,
 579  loop(i$((ord(i)>=27) and (ord(i)<=52)),
 580  totoutput3(r)=totoutput3(r)+sum(j,finalsam.l(r,i,j));
 581  );
 582  );
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                     04/09/12 10:26:38 Page 9
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 583   
 584  parameter totimp(i),totexp(i);
 585  totimp(i)$((ord(i)>=27) and (ord(i)<=52))=sum(r,finalsam.l(r,"63",i));
 586  totexp(i)$((ord(i)>=27) and (ord(i)<=52))=sum(r,finalsam.l(r,i,"63"));
 587   
 588  parameter sam5(r,i,j);
 589  loop(r,
 590  loop(i,
 591  loop(j,
 592  sam5(r,i,j)= finalsam.l(r,i,j);
 593  );
 594  );
 595  );
 596   
 597   
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                    04/09/12 10:26:38 Page 10
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Error Messages


170  Domain violation for element
257  Solve statement not checked because of previous errors

**** 2 ERROR(S)   0 WARNING(S)
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows                                                    04/09/12 10:26:38 Page 11
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\dzhang\Dropbox\ChinaBalancedSAM\tradebalancing2.gms
     2      115 GDXIN          1     115  C:\Users\dzhang\Dropbox\ChinaBalancedSAM\/data/gdx/finalbalancing2/sam4.gdx
     3      127 GDXIN          1     127  C:\Users\dzhang\Dropbox\ChinaBalancedSAM\/data/gdx/chinamodel.gdx
     4      368 GDXIN          1     368  C:\Users\dzhang\Dropbox\ChinaBalancedSAM\/data/gdx/gsd_001.gdx


COMPILATION TIME     =        0.156 SECONDS      4 Mb  WEX232-232 Aug 11, 2009


USER: Institute of Nuclear and New Energy Technology G101217:1031AV-WIN
      TsingHua Univerrsity                                       DC8455
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\dzhang\Dropbox\ChinaBalancedSAM\tradebalancing2.gms
Output     C:\Users\dzhang\Dropbox\ChinaBalancedSAM\listings\tradebalancing.lst

**** USER ERROR(S) ENCOUNTERED
